diff -Nurp -x '*~' -x '*.orig' tmp/nuttx/configs/Kconfig src/nuttx/configs/Kconfig
--- tmp/nuttx/configs/Kconfig	2015-06-10 21:03:49.805512468 +0300
+++ src/nuttx/configs/Kconfig	2015-06-12 13:45:22.162474882 +0300
@@ -785,7 +785,7 @@ config ARCH_BOARD_SKP16C26
 
 config ARCH_BOARD_SPARK
 	bool "Spark Core"
-	depends on ARCH_CHIP_STM32F103CB
+	depends on ARCH_CHIP_STM32F103CB || ARCH_CHIP_STM32F103RC
 	select ARCH_HAVE_LEDS
 	select ARCH_HAVE_BUTTONS
 	select ARCH_HAVE_IRQBUTTONS
diff -Nurp -x '*~' -x '*.orig' tmp/nuttx/configs/spark/nsh/defconfig src/nuttx/configs/spark/nsh/defconfig
--- tmp/nuttx/configs/spark/nsh/defconfig	2015-06-10 21:03:49.133512463 +0300
+++ src/nuttx/configs/spark/nsh/defconfig	2015-06-15 22:08:15.406921167 +0300
@@ -16,7 +16,7 @@ CONFIG_HOST_LINUX=y
 #
 # Build Configuration
 #
-# CONFIG_APPS_DIR="../apps"
+CONFIG_APPS_DIR="../apps"
 CONFIG_BUILD_FLAT=y
 # CONFIG_BUILD_2PASS is not set
 
@@ -41,15 +41,44 @@ CONFIG_RAW_BINARY=y
 #
 # Debug Options
 #
-# CONFIG_DEBUG is not set
+CONFIG_DEBUG=y
 CONFIG_ARCH_HAVE_HEAPCHECK=y
+# CONFIG_DEBUG_VERBOSE is not set
+
+#
+# Subsystem Debug Options
+#
+# CONFIG_DEBUG_AUDIO is not set
+# CONFIG_DEBUG_BINFMT is not set
+# CONFIG_DEBUG_FS is not set
+# CONFIG_DEBUG_GRAPHICS is not set
+# CONFIG_DEBUG_LIB is not set
+# CONFIG_DEBUG_MM is not set
+# CONFIG_DEBUG_NET is not set
+# CONFIG_DEBUG_SCHED is not set
+
+#
+# OS Function Debug Options
+#
+# CONFIG_DEBUG_DMA is not set
+# CONFIG_DEBUG_HEAP is not set
+# CONFIG_DEBUG_IRQ is not set
+
+#
+# Driver Debug Options
+#
+# CONFIG_DEBUG_LEDS is not set
+# CONFIG_DEBUG_ANALOG is not set
+# CONFIG_DEBUG_GPIO is not set
+# CONFIG_DEBUG_SPI is not set
+# CONFIG_DEBUG_USB is not set
 CONFIG_ARCH_HAVE_STACKCHECK=y
 # CONFIG_STACK_COLORATION is not set
-# CONFIG_DEBUG_SYMBOLS is not set
+CONFIG_DEBUG_SYMBOLS=y
 CONFIG_ARCH_HAVE_CUSTOMOPT=y
-# CONFIG_DEBUG_NOOPT is not set
+CONFIG_DEBUG_NOOPT=y
 # CONFIG_DEBUG_CUSTOMOPT is not set
-CONFIG_DEBUG_FULLOPT=y
+# CONFIG_DEBUG_FULLOPT is not set
 
 #
 # System Type
@@ -79,6 +108,7 @@ CONFIG_ARCH="arm"
 # CONFIG_ARCH_CHIP_KL is not set
 # CONFIG_ARCH_CHIP_LM is not set
 # CONFIG_ARCH_CHIP_TIVA is not set
+# CONFIG_ARCH_CHIP_LPC11XX is not set
 # CONFIG_ARCH_CHIP_LPC17XX is not set
 # CONFIG_ARCH_CHIP_LPC214X is not set
 # CONFIG_ARCH_CHIP_LPC2378 is not set
@@ -87,7 +117,9 @@ CONFIG_ARCH="arm"
 # CONFIG_ARCH_CHIP_NUC1XX is not set
 # CONFIG_ARCH_CHIP_SAMA5 is not set
 # CONFIG_ARCH_CHIP_SAMD is not set
+# CONFIG_ARCH_CHIP_SAML is not set
 # CONFIG_ARCH_CHIP_SAM34 is not set
+# CONFIG_ARCH_CHIP_SAMV7 is not set
 CONFIG_ARCH_CHIP_STM32=y
 # CONFIG_ARCH_CHIP_STR71X is not set
 # CONFIG_ARCH_ARM7TDMI is not set
@@ -96,6 +128,7 @@ CONFIG_ARCH_CHIP_STM32=y
 # CONFIG_ARCH_CORTEXM0 is not set
 CONFIG_ARCH_CORTEXM3=y
 # CONFIG_ARCH_CORTEXM4 is not set
+# CONFIG_ARCH_CORTEXM7 is not set
 # CONFIG_ARCH_CORTEXA5 is not set
 # CONFIG_ARCH_CORTEXA8 is not set
 CONFIG_ARCH_FAMILY="armv7-m"
@@ -103,18 +136,27 @@ CONFIG_ARCH_CHIP="stm32"
 # CONFIG_ARMV7M_USEBASEPRI is not set
 CONFIG_ARCH_HAVE_CMNVECTOR=y
 # CONFIG_ARMV7M_CMNVECTOR is not set
+# CONFIG_ARMV7M_LAZYFPU is not set
 # CONFIG_ARCH_HAVE_FPU is not set
+# CONFIG_ARCH_HAVE_DPFPU is not set
 # CONFIG_ARMV7M_MPU is not set
+# CONFIG_DEBUG_HARDFAULT is not set
 
 #
 # ARMV7M Configuration Options
 #
+# CONFIG_ARMV7M_HAVE_ICACHE is not set
+# CONFIG_ARMV7M_HAVE_DCACHE is not set
+# CONFIG_ARMV7M_HAVE_ITCM is not set
+# CONFIG_ARMV7M_HAVE_DTCM is not set
 # CONFIG_ARMV7M_TOOLCHAIN_BUILDROOT is not set
 # CONFIG_ARMV7M_TOOLCHAIN_CODEREDL is not set
 CONFIG_ARMV7M_TOOLCHAIN_CODESOURCERYL=y
 # CONFIG_ARMV7M_TOOLCHAIN_GNU_EABIL is not set
+CONFIG_ARMV7M_HAVE_STACKCHECK=y
 # CONFIG_ARMV7M_STACKCHECK is not set
 # CONFIG_ARMV7M_ITMSYSLOG is not set
+# CONFIG_SERIAL_TERMIOS is not set
 
 #
 # STM32 Configuration Options
@@ -138,6 +180,7 @@ CONFIG_ARMV7M_TOOLCHAIN_CODESOURCERYL=y
 # CONFIG_ARCH_CHIP_STM32L152V8 is not set
 # CONFIG_ARCH_CHIP_STM32L152VB is not set
 # CONFIG_ARCH_CHIP_STM32L162ZD is not set
+# CONFIG_ARCH_CHIP_STM32L162VE is not set
 # CONFIG_ARCH_CHIP_STM32F100C8 is not set
 # CONFIG_ARCH_CHIP_STM32F100CB is not set
 # CONFIG_ARCH_CHIP_STM32F100R8 is not set
@@ -155,10 +198,10 @@ CONFIG_ARMV7M_TOOLCHAIN_CODESOURCERYL=y
 # CONFIG_ARCH_CHIP_STM32F103TB is not set
 # CONFIG_ARCH_CHIP_STM32F103C4 is not set
 # CONFIG_ARCH_CHIP_STM32F103C8 is not set
-CONFIG_ARCH_CHIP_STM32F103CB=y
+# CONFIG_ARCH_CHIP_STM32F103CB is not set
 # CONFIG_ARCH_CHIP_STM32F103R8 is not set
 # CONFIG_ARCH_CHIP_STM32F103RB is not set
-# CONFIG_ARCH_CHIP_STM32F103RC is not set
+CONFIG_ARCH_CHIP_STM32F103RC=y
 # CONFIG_ARCH_CHIP_STM32F103RD is not set
 # CONFIG_ARCH_CHIP_STM32F103RE is not set
 # CONFIG_ARCH_CHIP_STM32F103RG is not set
@@ -169,8 +212,11 @@ CONFIG_ARCH_CHIP_STM32F103CB=y
 # CONFIG_ARCH_CHIP_STM32F103ZE is not set
 # CONFIG_ARCH_CHIP_STM32F105VB is not set
 # CONFIG_ARCH_CHIP_STM32F107VC is not set
+# CONFIG_ARCH_CHIP_STM32F205RG is not set
 # CONFIG_ARCH_CHIP_STM32F207IG is not set
 # CONFIG_ARCH_CHIP_STM32F207ZE is not set
+# CONFIG_ARCH_CHIP_STM32F302K6 is not set
+# CONFIG_ARCH_CHIP_STM32F302K8 is not set
 # CONFIG_ARCH_CHIP_STM32F302CB is not set
 # CONFIG_ARCH_CHIP_STM32F302CC is not set
 # CONFIG_ARCH_CHIP_STM32F302RB is not set
@@ -183,6 +229,24 @@ CONFIG_ARCH_CHIP_STM32F103CB=y
 # CONFIG_ARCH_CHIP_STM32F303RC is not set
 # CONFIG_ARCH_CHIP_STM32F303VB is not set
 # CONFIG_ARCH_CHIP_STM32F303VC is not set
+# CONFIG_ARCH_CHIP_STM32F372C8 is not set
+# CONFIG_ARCH_CHIP_STM32F372R8 is not set
+# CONFIG_ARCH_CHIP_STM32F372V8 is not set
+# CONFIG_ARCH_CHIP_STM32F372CB is not set
+# CONFIG_ARCH_CHIP_STM32F372RB is not set
+# CONFIG_ARCH_CHIP_STM32F372VB is not set
+# CONFIG_ARCH_CHIP_STM32F372CC is not set
+# CONFIG_ARCH_CHIP_STM32F372RC is not set
+# CONFIG_ARCH_CHIP_STM32F372VC is not set
+# CONFIG_ARCH_CHIP_STM32F373C8 is not set
+# CONFIG_ARCH_CHIP_STM32F373R8 is not set
+# CONFIG_ARCH_CHIP_STM32F373V8 is not set
+# CONFIG_ARCH_CHIP_STM32F373CB is not set
+# CONFIG_ARCH_CHIP_STM32F373RB is not set
+# CONFIG_ARCH_CHIP_STM32F373VB is not set
+# CONFIG_ARCH_CHIP_STM32F373CC is not set
+# CONFIG_ARCH_CHIP_STM32F373RC is not set
+# CONFIG_ARCH_CHIP_STM32F373VC is not set
 # CONFIG_ARCH_CHIP_STM32F401RE is not set
 # CONFIG_ARCH_CHIP_STM32F411RE is not set
 # CONFIG_ARCH_CHIP_STM32F405RG is not set
@@ -209,12 +273,14 @@ CONFIG_STM32_STM32F10XX=y
 # CONFIG_STM32_CONNECTIVITYLINE is not set
 CONFIG_STM32_PERFORMANCELINE=y
 # CONFIG_STM32_USBACCESSLINE is not set
-# CONFIG_STM32_HIGHDENSITY is not set
-CONFIG_STM32_MEDIUMDENSITY=y
+CONFIG_STM32_HIGHDENSITY=y
+# CONFIG_STM32_MEDIUMDENSITY is not set
 # CONFIG_STM32_LOWDENSITY is not set
 # CONFIG_STM32_STM32F20XX is not set
+# CONFIG_STM32_STM32F205 is not set
 # CONFIG_STM32_STM32F207 is not set
 # CONFIG_STM32_STM32F30XX is not set
+# CONFIG_STM32_STM32F37XX is not set
 # CONFIG_STM32_STM32F40XX is not set
 # CONFIG_STM32_STM32F401 is not set
 # CONFIG_STM32_STM32F411 is not set
@@ -230,7 +296,7 @@ CONFIG_STM32_MEDIUMDENSITY=y
 # CONFIG_STM32_HAVE_CCM is not set
 CONFIG_STM32_HAVE_USBDEV=y
 # CONFIG_STM32_HAVE_OTGFS is not set
-# CONFIG_STM32_HAVE_FSMC is not set
+CONFIG_STM32_HAVE_FSMC=y
 CONFIG_STM32_HAVE_USART3=y
 CONFIG_STM32_HAVE_UART4=y
 CONFIG_STM32_HAVE_UART5=y
@@ -273,6 +339,7 @@ CONFIG_STM32_DMA1=y
 # CONFIG_STM32_DMA2 is not set
 # CONFIG_STM32_DAC1 is not set
 # CONFIG_STM32_DAC2 is not set
+# CONFIG_STM32_FSMC is not set
 # CONFIG_STM32_I2C1 is not set
 # CONFIG_STM32_I2C2 is not set
 # CONFIG_STM32_PWR is not set
@@ -290,18 +357,22 @@ CONFIG_STM32_SPI2=y
 # CONFIG_STM32_TIM8 is not set
 # CONFIG_STM32_USART1 is not set
 CONFIG_STM32_USART2=y
-# CONFIG_STM32_USART3 is not set
+CONFIG_STM32_USART3=y
 # CONFIG_STM32_UART4 is not set
 # CONFIG_STM32_UART5 is not set
 CONFIG_STM32_USB=y
 # CONFIG_STM32_IWDG is not set
 # CONFIG_STM32_WWDG is not set
 CONFIG_STM32_SPI=y
+# CONFIG_STM32_NOEXT_VECTORS is not set
 
 #
 # Alternate Pin Mapping
 #
 # CONFIG_STM32_USART2_REMAP is not set
+CONFIG_STM32_USART3_NO_REMAP=y
+# CONFIG_STM32_USART3_FULL_REMAP is not set
+# CONFIG_STM32_USART3_PARTIAL_REMAP is not set
 # CONFIG_STM32_JTAG_DISABLE is not set
 CONFIG_STM32_JTAG_FULL_ENABLE=y
 # CONFIG_STM32_JTAG_NOJNTRST_ENABLE is not set
@@ -317,6 +388,8 @@ CONFIG_STM32_USART=y
 #
 # CONFIG_USART2_RS485 is not set
 # CONFIG_USART2_RXDMA is not set
+# CONFIG_USART3_RS485 is not set
+# CONFIG_USART3_RXDMA is not set
 # CONFIG_SERIAL_DISABLE_REORDERING is not set
 # CONFIG_STM32_FLOWCONTROL_BROKEN is not set
 # CONFIG_STM32_USART_SINGLEWIRE is not set
@@ -326,6 +399,7 @@ CONFIG_STM32_USART=y
 #
 # CONFIG_STM32_SPI_INTERRUPTS is not set
 CONFIG_STM32_SPI_DMA=y
+CONFIG_STM32_HAVE_RTC_COUNTER=y
 # CONFIG_STM32_HAVE_RTC_SUBSECONDS is not set
 
 #
@@ -397,13 +471,12 @@ CONFIG_BOOT_RUNFROMFLASH=y
 # Boot Memory Configuration
 #
 CONFIG_RAM_START=0x20000000
-CONFIG_RAM_SIZE=20480
+CONFIG_RAM_SIZE=65536
 # CONFIG_ARCH_HAVE_SDRAM is not set
 
 #
 # Board Selection
 #
-# CONFIG_ARCH_BOARD_MAPLE is not set
 CONFIG_ARCH_BOARD_SPARK=y
 # CONFIG_ARCH_BOARD_CUSTOM is not set
 CONFIG_ARCH_BOARD="spark"
@@ -426,6 +499,12 @@ CONFIG_SPARK_FLASH=y
 CONFIG_SPARK_FLASH_SPI=2
 CONFIG_SPARK_FLASH_MINOR=0
 # CONFIG_SPARK_FLASH_PART is not set
+CONFIG_LIB_BOARDCTL=y
+# CONFIG_BOARDCTL_TSCTEST is not set
+# CONFIG_BOARDCTL_ADCTEST is not set
+# CONFIG_BOARDCTL_PWMTEST is not set
+# CONFIG_BOARDCTL_GRAPHICS is not set
+# CONFIG_BOARDCTL_IOCTL is not set
 
 #
 # RTOS Features
@@ -517,10 +596,10 @@ CONFIG_MQ_MAXMSGSIZE=8
 #
 # Stack and heap information
 #
-CONFIG_IDLETHREAD_STACKSIZE=300
-CONFIG_USERMAIN_STACKSIZE=880
-CONFIG_PTHREAD_STACK_MIN=256
-CONFIG_PTHREAD_STACK_DEFAULT=464
+CONFIG_IDLETHREAD_STACKSIZE=512
+CONFIG_USERMAIN_STACKSIZE=2048
+CONFIG_PTHREAD_STACK_MIN=512
+CONFIG_PTHREAD_STACK_DEFAULT=2048
 # CONFIG_LIB_SYSCALL is not set
 
 #
@@ -546,8 +625,13 @@ CONFIG_SPI=y
 # CONFIG_SPI_OWNBUS is not set
 CONFIG_SPI_EXCHANGE=y
 # CONFIG_SPI_CMDDATA is not set
+# CONFIG_SPI_CALLBACK is not set
 # CONFIG_SPI_BITBANG is not set
 # CONFIG_I2S is not set
+
+#
+# Timer Driver Support
+#
 # CONFIG_TIMER is not set
 # CONFIG_RTC is not set
 # CONFIG_WATCHDOG is not set
@@ -616,7 +700,7 @@ CONFIG_SERIAL_REMOVABLE=y
 # CONFIG_ARCH_HAVE_USART0 is not set
 # CONFIG_ARCH_HAVE_USART1 is not set
 CONFIG_ARCH_HAVE_USART2=y
-# CONFIG_ARCH_HAVE_USART3 is not set
+CONFIG_ARCH_HAVE_USART3=y
 # CONFIG_ARCH_HAVE_USART4 is not set
 # CONFIG_ARCH_HAVE_USART5 is not set
 # CONFIG_ARCH_HAVE_USART6 is not set
@@ -628,13 +712,15 @@ CONFIG_ARCH_HAVE_USART2=y
 # USART Configuration
 #
 CONFIG_USART2_ISUART=y
+CONFIG_USART3_ISUART=y
 CONFIG_MCU_SERIAL=y
 CONFIG_STANDARD_SERIAL=y
 # CONFIG_SERIAL_IFLOWCONTROL is not set
 # CONFIG_SERIAL_OFLOWCONTROL is not set
+# CONFIG_SERIAL_TIOCSERGSTRUCT is not set
 CONFIG_ARCH_HAVE_SERIAL_TERMIOS=y
-# CONFIG_SERIAL_TERMIOS is not set
-CONFIG_USART2_SERIAL_CONSOLE=y
+# CONFIG_USART2_SERIAL_CONSOLE is not set
+CONFIG_USART3_SERIAL_CONSOLE=y
 # CONFIG_OTHER_SERIAL_CONSOLE is not set
 # CONFIG_NO_SERIAL_CONSOLE is not set
 
@@ -649,6 +735,18 @@ CONFIG_USART2_PARITY=0
 CONFIG_USART2_2STOP=0
 # CONFIG_USART2_IFLOWCONTROL is not set
 # CONFIG_USART2_OFLOWCONTROL is not set
+
+#
+# USART3 Configuration
+#
+CONFIG_USART3_RXBUFSIZE=256
+CONFIG_USART3_TXBUFSIZE=256
+CONFIG_USART3_BAUD=115200
+CONFIG_USART3_BITS=8
+CONFIG_USART3_PARITY=0
+CONFIG_USART3_2STOP=0
+# CONFIG_USART3_IFLOWCONTROL is not set
+# CONFIG_USART3_OFLOWCONTROL is not set
 CONFIG_USBDEV=y
 
 #
@@ -786,6 +884,7 @@ CONFIG_FS_FATTIME=y
 # CONFIG_FS_SMARTFS is not set
 # CONFIG_FS_BINFS is not set
 # CONFIG_FS_PROCFS is not set
+# CONFIG_FS_UNIONFS is not set
 
 #
 # System Logging
@@ -852,6 +951,7 @@ CONFIG_LIBC_TMPDIR="/tmp"
 CONFIG_LIBC_MAX_TMPFILE=32
 CONFIG_ARCH_LOWPUTC=y
 # CONFIG_LIBC_LOCALTIME is not set
+# CONFIG_TIME_EXTENDED is not set
 CONFIG_LIB_SENDFILE_BUFSIZE=0
 # CONFIG_ARCH_ROMGETC is not set
 # CONFIG_ARCH_OPTIMIZED_FUNCTIONS is not set
@@ -907,17 +1007,16 @@ CONFIG_EXAMPLES_NSH=y
 # CONFIG_EXAMPLES_NX is not set
 # CONFIG_EXAMPLES_NXTERM is not set
 # CONFIG_EXAMPLES_NXFFS is not set
-# CONFIG_EXAMPLES_NXFLAT is not set
 # CONFIG_EXAMPLES_NXHELLO is not set
 # CONFIG_EXAMPLES_NXIMAGE is not set
 # CONFIG_EXAMPLES_NXLINES is not set
 # CONFIG_EXAMPLES_NXTEXT is not set
 # CONFIG_EXAMPLES_OSTEST is not set
 # CONFIG_EXAMPLES_PIPE is not set
+# CONFIG_EXAMPLES_PPPD is not set
 # CONFIG_EXAMPLES_POSIXSPAWN is not set
 # CONFIG_EXAMPLES_QENCODER is not set
 # CONFIG_EXAMPLES_RGMP is not set
-# CONFIG_EXAMPLES_ROMFS is not set
 # CONFIG_EXAMPLES_SENDMAIL is not set
 # CONFIG_EXAMPLES_SERIALBLASTER is not set
 # CONFIG_EXAMPLES_SERIALRX is not set
@@ -927,7 +1026,6 @@ CONFIG_EXAMPLES_NSH=y
 # CONFIG_EXAMPLES_SMART is not set
 # CONFIG_EXAMPLES_TCPECHO is not set
 # CONFIG_EXAMPLES_TELNETD is not set
-# CONFIG_EXAMPLES_THTTPD is not set
 # CONFIG_EXAMPLES_TIFF is not set
 # CONFIG_EXAMPLES_TOUCHSCREEN is not set
 # CONFIG_EXAMPLES_WEBSERVER is not set
@@ -960,10 +1058,6 @@ CONFIG_EXAMPLES_NSH=y
 # CONFIG_NETUTILS_FTPC is not set
 # CONFIG_NETUTILS_JSON is not set
 # CONFIG_NETUTILS_SMTP is not set
-# CONFIG_NETUTILS_TFTPC is not set
-# CONFIG_NETUTILS_THTTPD is not set
-# CONFIG_NETUTILS_NETLIB is not set
-# CONFIG_NETUTILS_WEBCLIENT is not set
 
 #
 # FreeModBus
@@ -997,6 +1091,7 @@ CONFIG_NSH_BUILTIN_APPS=y
 # CONFIG_NSH_DISABLE_CD is not set
 # CONFIG_NSH_DISABLE_CP is not set
 # CONFIG_NSH_DISABLE_CMP is not set
+CONFIG_NSH_DISABLE_DATE=y
 # CONFIG_NSH_DISABLE_DD is not set
 CONFIG_NSH_DISABLE_DF=y
 # CONFIG_NSH_DISABLE_DELROUTE is not set
@@ -1018,6 +1113,7 @@ CONFIG_NSH_DISABLE_DF=y
 # CONFIG_NSH_DISABLE_MKRD is not set
 # CONFIG_NSH_DISABLE_MH is not set
 # CONFIG_NSH_DISABLE_MOUNT is not set
+# CONFIG_NSH_DISABLE_MV is not set
 # CONFIG_NSH_DISABLE_MW is not set
 # CONFIG_NSH_DISABLE_PS is not set
 # CONFIG_NSH_DISABLE_PUT is not set
@@ -1060,7 +1156,6 @@ CONFIG_NSH_CONSOLE=y
 #
 # CONFIG_NSH_USBDEV_TRACE is not set
 CONFIG_NSH_ARCHINIT=y
-CONFIG_LIB_BOARDCTL=y
 
 #
 # NxWidgets/NxWM
@@ -1074,129 +1169,25 @@ CONFIG_LIB_BOARDCTL=y
 #
 # System Libraries and NSH Add-Ons
 #
-
-#
-# Custom Free Memory Command
-#
 # CONFIG_SYSTEM_FREE is not set
-
-#
-# EMACS-like Command Line Editor
-#
 # CONFIG_SYSTEM_CLE is not set
-
-#
-# CU Minimal Terminal
-#
 # CONFIG_SYSTEM_CUTERM is not set
-
-#
-# FLASH Program Installation
-#
 # CONFIG_SYSTEM_INSTALL is not set
-
-#
-# FLASH Erase-all Command
-#
 # CONFIG_SYSTEM_FLASH_ERASEALL is not set
-
-#
-# Intel HEX to binary conversion
-#
 # CONFIG_SYSTEM_HEX2BIN is not set
-
-#
-# I2C tool
-#
-
-#
-# INI File Parser
-#
 # CONFIG_SYSTEM_INIFILE is not set
-
-#
-# NxPlayer media player library / command Line
-#
-
-#
-# RAM test
-#
 # CONFIG_SYSTEM_RAMTEST is not set
-
-#
-# readline()
-#
 CONFIG_SYSTEM_READLINE=y
 CONFIG_READLINE_ECHO=y
-
-#
-# P-Code Support
-#
-
-#
-# PHY Tool
-#
-
-#
-# Power Off
-#
 # CONFIG_SYSTEM_POWEROFF is not set
-
-#
-# RAMTRON
-#
 # CONFIG_SYSTEM_RAMTRON is not set
-
-#
-# SD Card
-#
 # CONFIG_SYSTEM_SDCARD is not set
-
-#
-# Sudoku
-#
 # CONFIG_SYSTEM_SUDOKU is not set
-
-#
-# Sysinfo
-#
 CONFIG_SYSTEM_SYSINFO=y
 CONFIG_SYSTEM_SYSINFO_STACKSIZE=1024
-
-#
-# Temperature
-#
-
-#
-# VI Work-Alike Editor
-#
 # CONFIG_SYSTEM_VI is not set
-
-#
-# Stack Monitor
-#
-
-#
-# USB CDC/ACM Device Commands
-#
 # CONFIG_SYSTEM_CDCACM is not set
-
-#
-# USB Composite Device Commands
-#
 # CONFIG_SYSTEM_COMPOSITE is not set
-
-#
-# USB Mass Storage Device Commands
-#
 # CONFIG_SYSTEM_USBMSC is not set
-
-#
-# USB Monitor
-#
 # CONFIG_SYSTEM_USBMONITOR is not set
-
-#
-# Zmodem Commands
-#
 # CONFIG_SYSTEM_ZMODEM is not set
diff -Nurp -x '*~' -x '*.orig' tmp/nuttx/configs/spark/scripts/ld.script src/nuttx/configs/spark/scripts/ld.script
--- tmp/nuttx/configs/spark/scripts/ld.script	2015-06-10 21:03:49.133512463 +0300
+++ src/nuttx/configs/spark/scripts/ld.script	2015-06-12 13:45:56.430473403 +0300
@@ -43,8 +43,8 @@
 
 MEMORY
 {
-    flash (rx) : ORIGIN = 0x08000000, LENGTH = 128K
-    sram (rwx) : ORIGIN = 0x20000000, LENGTH = 20K
+    flash (rx) : ORIGIN = 0x08000000, LENGTH = 256K
+    sram (rwx) : ORIGIN = 0x20000000, LENGTH = 64K
 }
 
 OUTPUT_ARCH(arm)
diff -Nurp -x '*~' -x '*.orig' tmp/nuttx/configs/spark/src/stm32_boot.c src/nuttx/configs/spark/src/stm32_boot.c
--- tmp/nuttx/configs/spark/src/stm32_boot.c	2015-06-10 21:03:49.133512463 +0300
+++ src/nuttx/configs/spark/src/stm32_boot.c	2015-06-15 21:50:44.742945191 +0300
@@ -72,6 +72,7 @@
 
 void stm32_boardinitialize(void)
 {
+#if 0
   /* Configure on-board LEDs if LED support has been selected. */
 
 #ifdef CONFIG_ARCH_LEDS
@@ -100,7 +101,7 @@ void stm32_boardinitialize(void)
   stm32_usbinitialize();
 #endif
 
-
+#endif
 }
 
 /****************************************************************************
diff -Nurp -x '*~' -x '*.orig' tmp/nuttx/configs/spark/src/stm32_nsh.c src/nuttx/configs/spark/src/stm32_nsh.c
--- tmp/nuttx/configs/spark/src/stm32_nsh.c	2015-06-12 14:17:28.250391796 +0300
+++ src/nuttx/configs/spark/src/stm32_nsh.c	2015-06-12 14:19:33.582386389 +0300
@@ -134,6 +134,7 @@
 
 int board_app_initialize(void)
 {
+#if 0
 #ifdef HAVE_SST25
   FAR struct spi_dev_s *spi;
   FAR struct mtd_dev_s *mtd;
@@ -281,7 +282,7 @@ int board_app_initialize(void)
       syslog(LOG_ERR, "ERROR: Failed to start USB monitor: %d\n", ret);
     }
 #endif
-
+#endif
   return OK;
 }
 
diff -Nurp -x '*~' -x '*.orig' tmp/nuttx/.version src/nuttx/.version
--- tmp/nuttx/.version	1970-01-01 03:00:00.000000000 +0300
+++ src/nuttx/.version	2015-06-12 13:47:05.030470444 +0300
@@ -0,0 +1,6 @@
+#!/bin/bash
+
+CONFIG_VERSION_STRING="0.0"
+CONFIG_VERSION_MAJOR=0
+CONFIG_VERSION_MINOR=0
+CONFIG_VERSION_BUILD="0"
